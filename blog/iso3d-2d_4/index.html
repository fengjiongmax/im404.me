<!DOCTYPE html>
<html lang="en-us">
    <head>
        
        
<script async src="https://www.googletagmanager.com/gtag/js?id=G-KPT6VZPK03"></script>
<script>
var doNotTrack = false;
if (!doNotTrack) {
	window.dataLayer = window.dataLayer || [];
	function gtag(){dataLayer.push(arguments);}
	gtag('js', new Date());
	gtag('config', 'G-KPT6VZPK03', { 'anonymize_ip': false });
}
</script>



<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="chrome=1">
<meta name="HandheldFriendly" content="True">
<meta name="MobileOptimized" content="320">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="referrer" content="no-referrer">

<title>
Isometric 3 D in 2 D Environment #4 Fall and Jump - fengjiongmax
</title>



        
        <meta property="og:title" content="Isometric 3D in 2D Environment #4 Fall and jump - fengjiongmax" />
<meta property="og:type" content="website" />
<meta property="og:description" content=""/>
<meta property="og:url" content="https://im404.me/blog/iso3d-2d_4/"/>
<meta property="og:site_name" content="fengjiongmax"/>




<meta property="og:image" content="https://im404.me/home/avatar.png"/>




        
<link rel="shortcut icon" href="/img/fav.ico">


        





<link rel="stylesheet" href="/css/main.min.424f46f9828895ed67f0fdbfacf94dac470c2905ee36e8eca3c726047cf38d04.css" integrity="sha256-Qk9G&#43;YKIle1n8P2/rPlNrEcMKQXuNujso8cmBHzzjQQ=" crossorigin="anonymous" media="screen">





        
        
        
        
    </head>
    <body>
        <section id="top" class="section">
            
            <div class="container hero ">
                

<h1 class="bold-title is-1">Blog</h1>


            </div>
            
            <div class="section ">
                

<div class="container">
    <hr>
    <nav class="navbar" role="navigation" aria-label="main navigation">
        
        <a role="button" class="navbar-burger" data-target="navMenu" aria-label="menu" aria-expanded="false" >
          <span aria-hidden="true"></span>
          <span aria-hidden="true"></span>
          <span aria-hidden="true"></span>
        </a>
        <div class="navbar-menu " id="navMenu">
            
            
            
            
            <a class="navbar-item" href="/">main</a>
            

            
            

            
                
            

            
                
            

            
            
            
            <a class="navbar-item" href="/#about">About</a>
            
            
            
            
            
                
                
                
                
                  <a class="navbar-item" href="https://im404.me/blog/">
                  
                  Back to Blog
                  
                  </a>
                
                
            
            
            
            
            
                
                
                
                
                  <a class="navbar-item" href="https://im404.me/projects/">
                  
                  
                  Projects
                  
                  
                  </a>
                
                
            
            
            
            

            
            
            

            

            
            <a class="navbar-item" href="https://im404.me/index.xml"><i class="fas fa-rss"></i></a>
            
            
        </div>
    </nav>
    <hr>
</div>




                
<div class="container">
    <h2 class="title is-1 top-pad strong-post-title">
        <a href="https://im404.me/blog/iso3d-2d_4/">Isometric 3D in 2D Environment #4 Fall and jump</a>
    </h2>
    
    <div class="post-data">
        Apr 21, 2021
        
         | 
        4 minutes read
        
    </div>
    
    <div class="blog-share">
        Share this:
        
        <a class="twitter-share-button"
            href="https://twitter.com/intent/tweet?text=Isometric%203D%20in%202D%20Environment%20%234%20Fall%20and%20jump%20https%3a%2f%2fim404.me%2fblog%2fiso3d-2d_4%2f"
            onclick="window.open(this.href, 'twitter-share', 'width=550,height=235');return false;">
            <i class="fab fa-twitter"></i>
            <span class="hidden">Twitter</span>
        </a>
        
        
        <a class="icon-facebook" href="https://www.facebook.com/sharer/sharer.php?u=https%3a%2f%2fim404.me%2fblog%2fiso3d-2d_4%2f"
            onclick="window.open(this.href, 'facebook-share','width=580,height=296');return false;">
            <i class="fab fa-facebook-f"></i>
            <span class="hidden">Facebook</span>
        </a>
        
        
        <a class="icon-pinterest"
            href="http://pinterest.com/pin/create/button/?url=https%3a%2f%2fim404.me%2fblog%2fiso3d-2d_4%2f&amp;description=Isometric%203D%20in%202D%20Environment%20%234%20Fall%20and%20jump"
            onclick="window.open(this.href, 'pinterest-share','width=580,height=296');return false;">
            <i class="fab fa-pinterest-p"></i>
            <span class="hidden">Pinterest</span>
        </a>
        
    </div>
    
    
    
    
    <p>
        Categories:
        
        <a href="/categories/ladder_box">
            Ladder_Box</a>
        
    </p>
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    <p>
        Series:
        
        <a href="/series/3d_iso_in_2d">
            3D_iso_in_2D</a>
        
    </p>
    
    
    
    
    <p>
        Tags:
        
        <a href="/tags/godot_engine">
            Godot_Engine</a>,
        
        <a href="/tags/tutorial">
            Tutorial</a>,
        
        <a href="/tags/gdscript">
            GDScript</a>,
        
        <a href="/tags/ladder_box">
            Ladder_Box</a>
        
    </p>
    
    
    
    
</div>

<div class="container markdown top-pad">
    <p>This is part 4 of the 2d/3d(game/engine) conversion used in my puzzle game: Ladder Box, which is available on Steam:</p>

<div style="position: relative; padding-bottom: 56.25%; height: 0; overflow: hidden;">
  <iframe src="https://www.youtube.com/embed/-PINYXwhEkc" style="position: absolute; top: 0; left: 0; width: 100%; height: 100%; border:0;" allowfullscreen title="YouTube Video"></iframe>
</div>

<p><a href="https://store.steampowered.com/app/1444390/Ladder_Box/"><img src="/img/steam.png" alt="get it on steam"></a></p>
<p>You can find all the textures, scripts in this GitHub repo: <a href="https://github.com/fengjiongmax/3D_iso_in_2D">https://github.com/fengjiongmax/3D_iso_in_2D</a></p>
<p>Godot 3.2.x is used in this project, you can check the commits for what&rsquo;s new in each part of this series.</p>

<h1 id="jump-state" class="anchor-link"><a href="#jump-state">Jump state</a></h1>
<p>When a movable has a block at its same height in its moving direction, that movable will switch to the jump state.<br>
Of course, before actually make the jump, the block needs to know if the way of jumping is clear or not, we write such function in movable.gd:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-gdscript" data-lang="gdscript"><span style="display:flex;"><span><span style="color:#66d9ef">func</span> is_direction_jumpable(direction:<span style="color:#a6e22e">Vector3</span>) <span style="color:#f92672">-&gt;</span> <span style="color:#a6e22e">bool</span>:
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">if</span> direction <span style="color:#f92672">in</span> [<span style="color:#a6e22e">Vector3</span><span style="color:#f92672">.</span>UP,<span style="color:#a6e22e">Vector3</span><span style="color:#f92672">.</span>DOWN]:
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">return</span> false
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">var</span> _self_up_coordinate <span style="color:#f92672">=</span> game_pos <span style="color:#f92672">+</span> <span style="color:#a6e22e">Vector3</span><span style="color:#f92672">.</span>UP
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">if</span> <span style="color:#f92672">!</span>Grid<span style="color:#f92672">.</span>coordinate_within_rangev(_self_up_coordinate):
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">return</span> false
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">var</span> _self_up_item <span style="color:#f92672">=</span> Grid<span style="color:#f92672">.</span>get_game_axisv(_self_up_coordinate)
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">if</span> _self_up_item <span style="color:#f92672">!=</span> null:
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">return</span> false
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">var</span> _direction_up_axie <span style="color:#f92672">=</span> game_pos <span style="color:#f92672">+</span> direction <span style="color:#f92672">+</span> <span style="color:#a6e22e">Vector3</span><span style="color:#f92672">.</span>UP
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">if</span> <span style="color:#f92672">!</span>Grid<span style="color:#f92672">.</span>coordinate_within_rangev(_direction_up_axie):
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">return</span> false
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">var</span> _direction_up_item <span style="color:#f92672">=</span> Grid<span style="color:#f92672">.</span>get_game_axisv(_direction_up_axie)
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">if</span> _direction_up_item <span style="color:#f92672">!=</span> null:
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">return</span> false
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">return</span> true
</span></span></code></pre></div><p>What’s in this function:</p>
<ul>
<li>check if <code>movable.game_pos.y +1</code> is empty or not</li>
<li>check if the game position after jump and move is clear or not.</li>
</ul>
<p>Now we can check if the block can jump at the end of the <code>set_next_target</code> function in the move.gd:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-gdscript" data-lang="gdscript"><span style="display:flex;"><span><span style="color:#66d9ef">func</span> set_next_target():
</span></span><span style="display:flex;"><span><span style="color:#f92672">......</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">else</span>:
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">if</span> movable<span style="color:#f92672">.</span>is_direction_jumpable(direction):
</span></span><span style="display:flex;"><span>        _state_machine<span style="color:#f92672">.</span>switch_state(<span style="color:#e6db74">&#34;jump&#34;</span>,{<span style="color:#e6db74">&#34;direction&#34;</span>:direction})
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">else</span>:
</span></span><span style="display:flex;"><span>        _state_machine<span style="color:#f92672">.</span>switch_state(<span style="color:#e6db74">&#34;idle&#34;</span>)
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">pass</span>
</span></span></code></pre></div><p>There are also scenarios when an unmovable is right next to a movable, so from idle to jump is necessary, so in <code>idle.gd</code>, modify the <code>_command</code> function:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-gdscript" data-lang="gdscript"><span style="display:flex;"><span><span style="color:#66d9ef">func</span> _command(_msg:<span style="color:#a6e22e">Dictionary</span><span style="color:#f92672">=</span>{}) <span style="color:#f92672">-&gt;</span> void:
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">if</span> _msg<span style="color:#f92672">.</span>keys()<span style="color:#f92672">.</span>has(<span style="color:#e6db74">&#34;direction&#34;</span>):
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">var</span> command <span style="color:#f92672">=</span> _msg[<span style="color:#e6db74">&#34;direction&#34;</span>]
</span></span><span style="display:flex;"><span>    match command:
</span></span><span style="display:flex;"><span>        <span style="color:#a6e22e">Vector3</span><span style="color:#f92672">.</span>FORWARD,<span style="color:#a6e22e">Vector3</span><span style="color:#f92672">.</span>BACK,<span style="color:#a6e22e">Vector3</span><span style="color:#f92672">.</span>LEFT,<span style="color:#a6e22e">Vector3</span><span style="color:#f92672">.</span>RIGHT:
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">pass</span>
</span></span><span style="display:flex;"><span>        _:
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">return</span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">var</span> _move_target_coordinate <span style="color:#f92672">=</span> movable<span style="color:#f92672">.</span>game_pos <span style="color:#f92672">+</span> command
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">if</span> Grid<span style="color:#f92672">.</span>coordinate_within_rangev(_move_target_coordinate) <span style="color:#f92672">&amp;&amp;</span>\
</span></span><span style="display:flex;"><span>       Grid<span style="color:#f92672">.</span>get_game_axisv(_move_target_coordinate) <span style="color:#f92672">==</span> null:
</span></span><span style="display:flex;"><span>        _state_machine<span style="color:#f92672">.</span>switch_state(<span style="color:#e6db74">&#34;move&#34;</span>,{<span style="color:#e6db74">&#34;direction&#34;</span>:command})
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">elif</span> movable<span style="color:#f92672">.</span>is_direction_jumpable(command):
</span></span><span style="display:flex;"><span>        _state_machine<span style="color:#f92672">.</span>switch_state(<span style="color:#e6db74">&#34;jump&#34;</span>,{<span style="color:#e6db74">&#34;direction&#34;</span>:command})
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">else</span>:
</span></span><span style="display:flex;"><span>        print(<span style="color:#e6db74">&#34;</span><span style="color:#e6db74">%s</span><span style="color:#e6db74"> not able to move&#34;</span> <span style="color:#f92672">%</span> _move_target_coordinate)
</span></span></code></pre></div><p>Then in our <code>jump.gd</code>, let’s write something that stores the move direction, and print something when movable enters jump state:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-gdscript" data-lang="gdscript"><span style="display:flex;"><span><span style="color:#66d9ef">extends</span> StateBase
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">var</span> move_direction:<span style="color:#a6e22e">Vector3</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">func</span> _enter(_msg:<span style="color:#f92672">=</span>{}) <span style="color:#f92672">-&gt;</span> void:
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">if</span> <span style="color:#f92672">!</span>_msg<span style="color:#f92672">.</span>keys()<span style="color:#f92672">.</span>has(<span style="color:#e6db74">&#34;direction&#34;</span>):
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">return</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    move_direction <span style="color:#f92672">=</span> _msg[<span style="color:#e6db74">&#34;direction&#34;</span>]
</span></span><span style="display:flex;"><span>    print(<span style="color:#e6db74">&#34;enter jump&#34;</span>)
</span></span></code></pre></div><p>And in our <code>main.gd</code>, to test the code we’ve written:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-gdscript" data-lang="gdscript"><span style="display:flex;"><span>new_movable(<span style="color:#ae81ff">0</span>,<span style="color:#ae81ff">0</span>,<span style="color:#ae81ff">0</span>)
</span></span><span style="display:flex;"><span>new_unmovable(<span style="color:#ae81ff">0</span>,<span style="color:#ae81ff">0</span>,<span style="color:#ae81ff">2</span>)
</span></span><span style="display:flex;"><span>new_unmovable(<span style="color:#ae81ff">1</span>,<span style="color:#ae81ff">0</span>,<span style="color:#ae81ff">0</span>)
</span></span></code></pre></div><p>Then run the project, you can see the output by hitting ‘Z or ‘X’.</p>

<h2 id="actual-jump-movement" class="anchor-link"><a href="#actual-jump-movement">Actual jump movement</a></h2>
<p>Like in the move state, we will have a <code>set_next_target</code> function and some variables.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-gdscript" data-lang="gdscript"><span style="display:flex;"><span><span style="color:#66d9ef">var</span> engine_direction:<span style="color:#a6e22e">Vector2</span> <span style="color:#f92672">=</span> GridUtils<span style="color:#f92672">.</span>game_direction_to_engine(<span style="color:#a6e22e">Vector3</span><span style="color:#f92672">.</span>UP)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">var</span> target_game_pos:<span style="color:#a6e22e">Vector3</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">var</span> target_z:<span style="color:#a6e22e">int</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">var</span> target_engine_pos:<span style="color:#a6e22e">Vector2</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">func</span> set_next_target():
</span></span><span style="display:flex;"><span>    target_game_pos <span style="color:#f92672">=</span> movable<span style="color:#f92672">.</span>game_pos <span style="color:#f92672">+</span> <span style="color:#a6e22e">Vector3</span><span style="color:#f92672">.</span>UP
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">var</span> _target_game_pos_obj <span style="color:#f92672">=</span> Grid<span style="color:#f92672">.</span>get_game_axisv(target_game_pos)
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">if</span> Grid<span style="color:#f92672">.</span>coordinate_within_rangev(target_game_pos) <span style="color:#f92672">&amp;&amp;</span> _target_game_pos_obj <span style="color:#f92672">==</span> null:
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">var</span> _target_v3 <span style="color:#f92672">=</span> GridUtils<span style="color:#f92672">.</span>game_to_enginev(target_game_pos)
</span></span><span style="display:flex;"><span>        target_engine_pos <span style="color:#f92672">=</span> <span style="color:#a6e22e">Vector2</span>(_target_v3<span style="color:#f92672">.</span>x,_target_v3<span style="color:#f92672">.</span>y)
</span></span><span style="display:flex;"><span>        target_z <span style="color:#f92672">=</span> _target_v3<span style="color:#f92672">.</span>z<span style="color:#f92672">-</span><span style="color:#ae81ff">1</span>
</span></span><span style="display:flex;"><span>        movable<span style="color:#f92672">.</span>set_game_posv(target_game_pos)
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">else</span>:
</span></span><span style="display:flex;"><span>        _state_machine<span style="color:#f92672">.</span>switch_state(<span style="color:#e6db74">&#34;idle&#34;</span>)
</span></span></code></pre></div><ul>
<li><strong>and call the set_next_target function at the end of the _enter function</strong></li>
</ul>
<p>note we did not use the direction passed from the last state to calculate <code>engine_direction</code>, but we need to store this because the jump state always goes up, and when movable exits jump state, it can go back to move state, then we will need <code>move_direction</code>.</p>
<p>Then in the <code>_update</code> function, we will move the movable, bit by bit like in the move state:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-gdscript" data-lang="gdscript"><span style="display:flex;"><span><span style="color:#66d9ef">func</span> _update(_delta:<span style="color:#a6e22e">float</span>) <span style="color:#f92672">-&gt;</span> void:
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">var</span> _after_move <span style="color:#f92672">=</span> movable<span style="color:#f92672">.</span>position <span style="color:#f92672">+</span> engine_direction <span style="color:#f92672">*</span> _delta <span style="color:#f92672">*</span> movable<span style="color:#f92672">.</span>MOVESPEED
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">var</span> _reach_target <span style="color:#f92672">=</span> Math<span style="color:#f92672">.</span>is_betweenv(movable<span style="color:#f92672">.</span>position,_after_move,target_engine_pos)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">if</span> <span style="color:#f92672">!</span>_reach_target:
</span></span><span style="display:flex;"><span>        movable<span style="color:#f92672">.</span>position <span style="color:#f92672">=</span> _after_move
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">else</span>:
</span></span><span style="display:flex;"><span>        movable<span style="color:#f92672">.</span>position <span style="color:#f92672">=</span> target_engine_pos
</span></span><span style="display:flex;"><span>        _state_machine<span style="color:#f92672">.</span>switch_state(<span style="color:#e6db74">&#34;move&#34;</span>,{<span style="color:#e6db74">&#34;direction&#34;</span>:move_direction})
</span></span></code></pre></div><p>And run the scene and hit ‘Z’, then you can see this:
<img src="/img/iso3D-2D-4th/z_float.gif" alt=""></p>
<p>the movable floats after it moves past the unmovable.</p>

<h1 id="fall-state" class="anchor-link"><a href="#fall-state">Fall state</a></h1>
<p>Just like move and jump state, there will be a <code>set_next_target</code> and all those variables:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-gdscript" data-lang="gdscript"><span style="display:flex;"><span><span style="color:#66d9ef">func</span> set_next_target():
</span></span><span style="display:flex;"><span>    target_game_pos <span style="color:#f92672">=</span> movable<span style="color:#f92672">.</span>game_pos <span style="color:#f92672">+</span> <span style="color:#a6e22e">Vector3</span><span style="color:#f92672">.</span>DOWN
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">var</span> _target_game_pos_obj <span style="color:#f92672">=</span> Grid<span style="color:#f92672">.</span>get_game_axisv(target_game_pos)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">if</span> Grid<span style="color:#f92672">.</span>coordinate_within_rangev(target_game_pos) <span style="color:#f92672">&amp;&amp;</span> _target_game_pos_obj <span style="color:#f92672">==</span> null:
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">var</span> _target_v3 <span style="color:#f92672">=</span> GridUtils<span style="color:#f92672">.</span>game_to_enginev(target_game_pos)
</span></span><span style="display:flex;"><span>        target_engine_pos <span style="color:#f92672">=</span> <span style="color:#a6e22e">Vector2</span>(_target_v3<span style="color:#f92672">.</span>x,_target_v3<span style="color:#f92672">.</span>y)
</span></span><span style="display:flex;"><span>        target_z <span style="color:#f92672">=</span> _target_v3<span style="color:#f92672">.</span>z
</span></span><span style="display:flex;"><span>        movable<span style="color:#f92672">.</span>set_game_posv(target_game_pos)
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">else</span>:
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">if</span> movable<span style="color:#f92672">.</span>is_direction_movable(move_direction):
</span></span><span style="display:flex;"><span>            _state_machine<span style="color:#f92672">.</span>switch_state(<span style="color:#e6db74">&#34;move&#34;</span>,{<span style="color:#e6db74">&#34;direction&#34;</span>:move_direction})
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">elif</span> movable<span style="color:#f92672">.</span>is_direction_jumpable(move_direction):
</span></span><span style="display:flex;"><span>            _state_machine<span style="color:#f92672">.</span>switch_state(<span style="color:#e6db74">&#34;jump&#34;</span>,{<span style="color:#e6db74">&#34;direction&#34;</span>:move_direction})
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">else</span>:
</span></span><span style="display:flex;"><span>            _state_machine<span style="color:#f92672">.</span>switch_state(<span style="color:#e6db74">&#34;idle&#34;</span>)
</span></span></code></pre></div><p>And we can copy the <code>_enter</code> function from the jump state and paste it in fall.gd, and modify a little bit in the <code>_update</code> function:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-gdscript" data-lang="gdscript"><span style="display:flex;"><span><span style="color:#66d9ef">func</span> _update(_delta:<span style="color:#a6e22e">float</span>) <span style="color:#f92672">-&gt;</span> void:
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">var</span> _after_move <span style="color:#f92672">=</span> movable<span style="color:#f92672">.</span>position <span style="color:#f92672">+</span> engine_direction <span style="color:#f92672">*</span> _delta <span style="color:#f92672">*</span> movable<span style="color:#f92672">.</span>MOVESPEED
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">var</span> _reach_target <span style="color:#f92672">=</span> Math<span style="color:#f92672">.</span>is_betweenv(movable<span style="color:#f92672">.</span>position,_after_move,target_engine_pos)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">if</span> <span style="color:#f92672">!</span>_reach_target:
</span></span><span style="display:flex;"><span>        movable<span style="color:#f92672">.</span>position <span style="color:#f92672">=</span> _after_move
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">else</span>:
</span></span><span style="display:flex;"><span>        movable<span style="color:#f92672">.</span>position <span style="color:#f92672">=</span> target_engine_pos
</span></span><span style="display:flex;"><span>        set_next_target()
</span></span></code></pre></div><p>Then run the scene and hit ‘Z’:
<img src="/img/iso3D-2D-4th/z_fall.gif" alt=""></p>
<p>run the scene hit ‘X’:
<img src="/img/iso3D-2D-4th/x_fall.gif" alt=""></p>
<p>That’s it, we have the basics for the jump and fall.</p>
<p>Till now, we don’t have many movables or complicated unmovable structures on our board like in Ladder Box, you can try to add more movables and see what happens.
In the next part, we will test the code with different board designs and improve our codes, stay tuned!
You can check out the Github repo for the code committed.</p>

</div>


    <div class="container disqus">
        <div id="disqus_thread"></div>
<script type="application/javascript">
    window.disqus_config = function () {
    
    
    
    };
    (function() {
        if (["localhost", "127.0.0.1"].indexOf(window.location.hostname) != -1) {
            document.getElementById('disqus_thread').innerHTML = 'Disqus comments not available by default when the website is previewed locally.';
            return;
        }
        var d = document, s = d.createElement('script'); s.async = true;
        s.src = '//' + "fjmax" + '.disqus.com/embed.js';
        s.setAttribute('data-timestamp', +new Date());
        (d.head || d.body).appendChild(s);
    })();
</script>
<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
<a href="https://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>
    </div>



                
                <div class="container">
    <hr>
</div>
<div class="container has-text-centered top-pad">
    <a href="#top">
        <i class="fa fa-arrow-up"></i>
    </a>
</div>

<div class="container">
    <hr>
</div>

                <div class="section" id="footer">
    <div class="container has-text-centered">
    
        <span class="footer-text">
            <a href="https://github.com/victoriadrake/hugo-theme-introduction/"><strong>Introduction</strong></a> theme for <a href="http://gohugo.io/">Hugo</a>. Made with <a href="https://victoria.dev"><!-- raw HTML omitted --><!-- raw HTML omitted --> and <!-- raw HTML omitted --><!-- raw HTML omitted --></a> by open source contributors.
        </span>
    
    </div>
</div>

                
            </div>
        </section>
        
        


<script src="https://im404.me/js/bundle.5c23c0437f001a469ca373a465a6f7487203d18e10cdff76d86a60af66d5ee28.js" integrity="sha256-XCPAQ38AGkaco3OkZab3SHID0Y4Qzf922Gpgr2bV7ig="></script>




        
        
        
        
    </body>
</html>
